{% extends 'base.html' %}

{% block recursos %}

        <!-- DataTables CSS -->
        <link rel="stylesheet" type="text/css" href="/static/DataTables/media/css/jquery.dataTables.css">

        <!-- jQuery -->
        <script type="text/javascript" charset="utf8" src="/static/DataTables/media/js/jquery.js"></script>

        <!-- DataTables -->
        <script type="text/javascript" charset="utf8" src="/static/DataTables/media/js/jquery.dataTables.js"></script>

    <style>
        .sinBorde{
            background: none;
            border: none;
        }
    </style>



{% endblock %}


{%  block contenido%}
    <br/>
<div class="row">

          <div class="col-xs-12">

              <!-- Nav tabs -->
                <ul class="nav nav-tabs" role="tablist">
                  <li role="presentation" class="active"><a href="#puertas" role="tab" data-toggle="tab">Puertas</a></li>
                  <li role="presentation"><a href="#registros" role="tab" data-toggle="tab">Registros</a></li>
                  <li role="presentation"><a href="#usuarios" role="tab" data-toggle="tab">Usuarios</a></li>
                  <li role="presentation"><a href="#informacion" role="tab" data-toggle="tab">Modificar Contrase√±a</a></li>
                    <li class="pull-right" ><a href="/cerrarSesion/" >CERRAR SESION</a></li>

                </ul>

                <!-- Tab panes -->
                <div class="tab-content">
                  <div role="tabpanel" class="tab-pane fade in active" id="puertas">
                      <br/>
                      <div class="row">


                          <div class="col-md-4" align="center">
                              <form action="/lab1/" method="POST">
                                    <button type="submit" class="sinBorde">
                                        <img class="img-responsive" src="/static/img/lab1.png" alt="lab1"/>
                                    </button>
                              </form>
                          </div>


                          <div class="col-md-4" align="center">
                              <form action="/lab2/" method="POST">
                                    <button type="submit" class="sinBorde">
                                        <img class="img-responsive" src="/static/img/lab2.png" alt="lab2"/>
                                    </button>
                              </form>
                          </div>

                          <div class="col-md-4" align="center">
                              <form action="/lab3/" method="POST">
                                    <button type="submit" class="sinBorde">
                                        <img class="img-responsive" src="/static/img/lab3.png" alt="lab3"/>
                                    </button>
                              </form>
                          </div>

                      </div>

                      <br/>
                      <div class="row">
                          <div class="col-md-4" align="center">
                              <form action="/lab4/" method="POST">
                                    <button type="submit" class="sinBorde">
                                        <img class="img-responsive" src="/static/img/lab4.png" alt="lab4"/>
                                    </button>
                              </form>
                          </div>

                          <div class="col-md-4" align="center">
                              <form action="/lab5/" method="POST">
                                    <button type="submit" class="sinBorde">
                                        <img class="img-responsive" src="/static/img/lab5.png" alt="lab5"/>
                                    </button>
                              </form>
                          </div>

                          <div class="col-md-4" align="center">
                              <form action="/lab6/" method="POST">
                                    <button type="submit" class="sinBorde">
                                        <img class="img-responsive" src="/static/img/lab6.png" alt="lab6"/>
                                    </button>
                              </form>
                          </div>

                      </div>

                      <br/>
                      <div class="row">
                          <div class="col-md-4" align="center">
                              <form action="/telecomunicaciones/" method="POST">
                                    <button type="submit" class="sinBorde">
                                        <img class="img-responsive" src="/static/img/telecomunicaciones.png" alt="telecomunicaciones"/>
                                    </button>
                              </form>
                          </div>

                          <div class="col-md-4" align="center">
                              <form action="/mac/" method="POST">
                                    <button type="submit" class="sinBorde">
                                        <img class="img-responsive" src="/static/img/mac.png" alt="mac"/>
                                    </button>
                              </form>
                          </div>

                          <div class="col-md-4" align="center">
                              <form action="/electronica/" method="POST">
                                    <button type="submit" class="sinBorde">
                                        <img class="img-responsive" src="/static/img/electronica.png" alt="electronica"/>
                                    </button>
                              </form>
                          </div>




                      </div>

                      <br/>
                      <div class="row">
                          <div class="col-md-4" align="center">
                              <form action="/direccion/" method="POST">
                                    <button type="submit" class="sinBorde">
                                        <img class="img-responsive" src="/static/img/direccion.png" alt="direccion"/>
                                    </button>
                              </form>
                          </div>

                          <div class="col-md-4" align="center">
                              <form action="/ciditec/" method="POST">
                                    <button type="submit" class="sinBorde">
                                        <img class="img-responsive" src="/static/img/ciditec.png" alt="ciditec"/>
                                    </button>
                              </form>
                          </div>

                          <div class="col-md-4" align="center">
                              <form action="/administradorTecnico/" method="POST">
                                    <button type="submit" class="sinBorde">
                                        <img class="img-responsive" src="/static/img/administradorTecnico.png" alt="administradorTecnico"/>
                                    </button>
                              </form>
                          </div>

                      </div>

                  </div>




                <div role="tabpanel" class="tab-pane fade" id="registros">
                      <br/>

                        <div class="row">

                        {% for i in registros %}
                           {{ i.id }}&nbsp;{{ i.nombre_persona }}&nbsp;{{ i.apellido_persona }}&nbsp;{{ i.puerta }}&nbsp;  {{ i.fecha }}&nbsp;
                        {% endfor %}
                        </div>

                  </div>


                  <div role="tabpanel" class="tab-pane fade" id="usuarios">

                      <br/>

                        <button type="button" onclick="window.location.href='/nuevoUsuario/'" class="btn btn-primary" data-dismiss="modal">Ingresar Nuevo Usuario</button>
                      <br/> <br/>


                        <div class="table-responsive">
                                <table class="table table-striped table-content table-bordered table-hover " xmlns="http://www.w3.org/1999/html" id="table_id">

                                <thead class="btn-primary cabeceraTabla">
                                <th>ID</th>
                                <th>NOMBRE</th>
                                <th>APELLIDO</th>
                                <th>USUARIO</th>
                                <th>PASSWORD</th>
                                <th style="text-align: center">ACCIONES</th>
                                </thead>

                                <tbody>


                                    {% for i in usuarios %}

                                        <tr>
                                        <td id="id_{{ i.id_personal }}">{{i.id_personal}}</td>
                                        <td id="nombre_{{i.id_personal}}">{{i.nombre}}</td>
                                        <td id="apellido_{{i.id_personal}}">{{i.apellido}}</td>
                                        <td id="username_{{i.id_personal}}">{{i.username}}</td>
                                        <td id="clave_{{i.id_personal}}">{{i.clave}}</td>

                                    {% comment %} <td><button class="btn btn-success" id="Guardar" onclick="editarRegistro({{ i.codigo_terrateniente }})">Editar</button></td>{% endcomment %}
                                        <td>
                                        <button  id ="Editar" onclick="editarRegistro({{ i.id_personal }})" class="btn btn-success">
                                        Editar
                                        </button>
                                        <button  id ="Eliminar" onclick="eliminarRegistro({{i.id_personal}})" class="btn btn-danger" data-toggle="modal" data-target="#myModal">

                                        Eliminar
                                        </button>

                                        </td>

                                        </tr>

                                {% endfor %}
                                </tbody>
                            </table>
                        </div>


                  {% for i in lista %}

                    {{ i }}
                  {% endfor %}


                  </div>

                  <div role="tabpanel" class="tab-pane fade" id="informacion">
                      <br/>

                        <div class="row">
                            <div class="col-md-2"></div>
                            <div class="col-md-5">
                                <div class="form-group">
                                    <label for="passwdActual">Contrase√±a Actual <label style="color:#EF4836"></label></label>
                                    <input type="password" name="passwdActual" class="form-control" id="passwdActual"  required>
                                    <label id="mensaje" style="color:#EF4836;"></label>
                                </div>

                                <div class="form-group">
                                    <label for="passwdNueva">Nueva Contrase√±a</label>
                                    <input type="password"  name="passwdNueva" class="form-control" id="passwdNueva"  required>
                                </div>
                                <label id="mensaje2" style="color:#EF4836;"></label>
                            </div>

                            <div class="col-md-5"></div>
                        </div>
                        <div class="row">
                            <div class="col-md-2"></div>
                            <div class="col-md-5">
                                <button type="button" onclick="verificar()" class="btn btn-primary">Guardar Cambios</button>
                                <button type="button" onclick="window.location.href='/administrador/'" class="btn btn-danger" data-dismiss="modal">Cerrar sin guardar</button>
                            </div>
                            <div class="col-md-5"></div>
                        </div>
                  </div>

                </div>
          </div>

</div>

<!-- modal de elimiar-->


<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title" id="myModalLabel">Eliminar registro</h4>
      </div>
      <div class="modal-body">

<form method="POST" action="/eliminarUsuario/" class="well"  role="form" >

  <div class="row">
      <div class="col-md-6">
          <div class="form-group">
            <label for="id">ID</label>
            <input type="text" name="id" class="form-control" id="id" readonly="readonly">
          </div>
      </div>
      <div class="col-md-6"></div>

  </div>

  <div class="row">
      <div class="col-md-6">
        <div class="form-group">
            <label for="nombres">Nombres</label>
            <input type="text" name="nombre" class="form-control" id="nombres"   readonly="readonly">
        </div>
      </div>

      <div class="col-md-6">
        <div class="form-group">
            <label for="apellidos" >Apellidos</label>
            <input type="text"  name="apellido" class="form-control" id="apellidos"  readonly="readonly">
        </div>
       </div>

  </div>



      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar sin eliminar</button>
        <button type="submit" class="btn btn-danger">Eliminar Registro</button>
          </div>
          </form>

      </div>
    </div>
  </div>

</div>
<!-- fin del modal-->



<script>

    $(document).ready(function() {
        $('#table_id').dataTable( {
            "language": {
                "sProcessing":     "Procesando...",
                "sLengthMenu":     "Mostrar _MENU_ registros",
                "sZeroRecords":    "No se encontraron resultados",
                "sEmptyTable":     "Ning√∫n dato disponible en esta tabla",
                "sInfo":           "Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros",
                "sInfoEmpty":      "Mostrando registros del 0 al 0 de un total de 0 registros",
                "sInfoFiltered":   "(filtrado de un total de _MAX_ registros)",
                "sInfoPostFix":    "",
                "sSearch":         "Buscar:",
                "sUrl":            "",
                "sInfoThousands":  ",",
                "sLoadingRecords": "Cargando...",
                "oPaginate": {
                    "sFirst":    "Primero",
                    "sLast":     "√öltimo",
                    "sNext":     "Siguiente",
                    "sPrevious": "Anterior"
                },
                "oAria": {
                    "sSortAscending":  ": Activar para ordenar la columna de manera ascendente",
                    "sSortDescending": ": Activar para ordenar la columna de manera descendente"
                }
            }
        } );
    } );




function editarRegistro(idUsuario){
    // Creamos el formulario auxiliar
    var form = document.createElement( "form" );

    // Le a√±adimos atributos como el name, action y el method
    form.setAttribute( "name", "formulario" );
    form.setAttribute( "action", "/usuarioEspecifico/" );
    form.setAttribute( "method", "post" );

    // Creamos un input para enviar el valor
    var input = document.createElement( "input" );

    // Le a√±adimos atributos como el name, type y el value
    input.setAttribute( "name", "idUsuario" );
    input.setAttribute( "type", "hidden" );
    input.setAttribute( "value", idUsuario );

    // A√±adimos el input al formulario
    form.appendChild( input );

    // A√±adimos el formulario al documento
    document.getElementsByTagName( "body" )[0].appendChild( form );

    // Hacemos submit
    document.formulario.submit();
}


function eliminarRegistro(id){
        var valor = document.getElementById("nombre_"+id).innerText;
        console.log(valor);
        document.getElementById("id").setAttribute("value",id);
        document.getElementById("nombres").setAttribute("value",valor);
        valor = document.getElementById("apellido_"+id).innerText;-
        document.getElementById("apellidos").setAttribute("value",valor);

    }


function verificar(){
        var pass1= document.getElementById("passwdActual").value;
        var pass2= document.getElementById("passwdNueva").value;


        if(pass1 == "" || pass2== "")
            $('#mensaje2').html('Por favor completa todos los campos');
        else{
            $('#mensaje2').html('');
            verificarPasswords(pass1,pass2);
        }
    }

function verificarPasswords(pass1, pass2){

        $.ajax({
           data : {'pass1':pass1 , 'pass2':pass2},
            url : '/comprobarPasswords/',
            type: 'get',
            success:function(data){

                if(data==0){
                    $('#mensaje2').html('CONTRASE√ëA ACTUAL INCORRECTA');
                    //console.log("1");
                    //var frmPrincipal = document.getElementById( 'frmPrincipal' );
                    //frmPrincipal.submit();
                }else{

                    $('#mensaje2').html('CONTRASE√ëAS ACTUALIZADAS');
                    document.getElementById("passwdActual").value='';
                    document.getElementById("passwdNueva").value='';
                }

           }//fin del data
        });//fin del ajax
    }
</script>




{% endblock %}